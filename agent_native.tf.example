# EXPERIMENTAL: Native Terraform Agent Creation
# This file demonstrates how to create the agent directly in Terraform
# if/when the Snowflake provider adds support for generic SQL execution

# Uncomment and test if snowflake_unsafe_execute or similar resource becomes available:

/*
resource "snowflake_unsafe_execute" "create_agent" {
  execute = local.agent_sql
  revert  = "DROP AGENT IF EXISTS ${var.agent_name}"
  
  depends_on = [
    snowflake_function.euno_instructions_wrapper,
    snowflake_function.euno_search_resources_wrapper,
    # ... all other wrapper functions
  ]
}

# Grant agent usage to role
resource "snowflake_unsafe_execute" "grant_agent_usage" {
  execute = "GRANT USAGE ON AGENT ${var.agent_name} TO ROLE ${var.role_name}"
  revert  = "REVOKE USAGE ON AGENT ${var.agent_name} FROM ROLE ${var.role_name}"
  
  depends_on = [
    snowflake_unsafe_execute.create_agent,
    snowflake_role.euno_agent_user
  ]
}
*/

# Alternative approaches that might work:
# 1. null_resource with local-exec provisioner (requires snowsql CLI)
# 2. terraform_data with triggers
# 3. Custom provider wrapper

/*
resource "null_resource" "create_agent" {
  triggers = {
    agent_sql_hash = md5(local.agent_sql)
  }
  
  provisioner "local-exec" {
    command = <<-EOT
      echo "${local.agent_sql}" | snowsql -c <connection_name>
    EOT
  }
  
  provisioner "local-exec" {
    when    = destroy
    command = "echo 'DROP AGENT IF EXISTS ${var.agent_name}' | snowsql -c <connection_name>"
  }
  
  depends_on = [
    snowflake_function.euno_instructions_wrapper,
    # ... all wrapper functions
  ]
}
*/
